{
  "path": "doc/TEST_RESULTS.md",
  "severity": 23,
  "problems": [],
  "original_code": "# テスト結果レポート\n\n**最終更新**: 2025-09-28 12:56:09\n**バージョン**: 1.2\n\n## 実行環境\n\n### システム環境\n- **OS**: Windows 11\n- **Python**: 3.11\n- **実行日時**: 2025-09-28 12:56:09\n- **テストディレクトリ**: C:\\Users\\kenji\\Dropbox\\AI開発\\dev\\Tools\\サーチ\n\n### テスト対象\n- **総ファイル数**: 14,355個（C#ソースファイル）\n- **ディレクトリ構造**: src/csharp/OfferSource, src/csharp/Source/Server\n- **総コード行数**: 約200万行\n\n## テスト実行結果\n\n### 1. インデックス作成テスト\n\n#### テスト条件\n- **対象**: src/csharp/OfferSource\n- **除外言語**: なし（全言語対象）\n- **ファイルサイズ制限**: 3MB\n\n#### 結果\n```\n実行時間: 約30秒\nインデックス化: 1,195ファイル\nスキップ: 2ファイル（3MB超過）\nエンコーディング: 自動検出成功\n```\n\n### 2. ベクトル化テスト\n\n#### テスト条件\n- **入力**: .advice_index.jsonl（1,195ドキュメント）\n- **アルゴリズム**: TF-IDF\n\n#### 結果\n```\n実行時間: 約10秒\n出力ファイル:\n- .advice_tfidf.pkl (117KB)\n- .advice_matrix.pkl (49KB)\n状態: ✅ 成功\n```\n\n### 3. ルールベース解析テスト\n\n#### テスト条件\n- **クエリ**: \"データベース SELECT\"\n- **解析対象**: 上位50ファイル\n- **モード**: ルールベース解析のみ\n\n#### 結果\n```\n実行時間: 約5秒\n解析完了: 50/50ファイル\n検出問題:\n- 🔴 緊急: 5件\n- 🟡 中: 7件\n- ⚪ なし: 38件\n```\n\n#### 検出された主要な問題\n| 問題タイプ | 件数 | 重要度スコア |\n|-----------|------|-------------|\n| D",
  "analysis": "## 1. 問題の詳細分析\n1. **個人情報（PII）の露出**  \n   - 記録されているパス `C:\\Users\\kenji\\Dropbox\\AI開発\\dev\\Tools\\サーチ` により、利用者のユーザー名やDropbox利用状況などが推測可能です。  \n   - 公開リポジトリや共有ドキュメントに含まれると個人情報流出や社会工学的攻撃のリスクが高まります。\n\n2. **内部ディレクトリ構造・ファイル規模情報の過度な公開**  \n   - `src/csharp/OfferSource` などの詳細なディレクトリ構造やソースファイル数、コード行数が記載されており、プロジェクト内部構成を外部に晒す形になります。  \n   - 攻撃者にとって有用な偵察情報となり得るため、公開範囲を限定するかレポートを匿名化する必要があります。\n\n3. **タイムスタンプ・バージョン情報の固定化**  \n   - テスト日時やバージョンが固定記載されており、レポートを再利用・再配布した際に内容の鮮度が誤解される恐れがあります。  \n   - 自動更新されない場合は誤情報による判断ミスにつながるため、テンプレート化・変数化すべきです。\n\n## 2. 改善コード\n### Before（問題のあるコード）\n```markdown\n- **実行日時**: 2025-09-28 12:56:09\n- **テストディレクトリ**: C:\\Users\\kenji\\Dropbox\\AI開発\\dev\\Tools\\サーチ\n...\n- **ディレクトリ構造**: src/csharp/OfferSource, src/csharp/Source/Server\n- **総コード行数**: 約200万行\n```\n\n### After（改善後のコード）\n```markdown\n- **実行日時**: {{TEST_RUN_AT}}  <!-- CI等で自動埋め込み -->\n- **テストディレクトリ**: {{PROJECT_ROOT}}  <!-- 具体的な個人パスは記載しない -->\n...\n- **ディレクトリ構造の概要**: {{ANONYMIZED_DIR_INFO}}  <!-- 例: \"主要モジュールを2つに分割\" -->\n- **総コード行数**: {{LOC_SUMMARY}}  <!-- 必要に応じて範囲表現や丸めた値を使用 -->\n```\n\n## 3. 追加の改善提案\n- レポートを公開用途と内部用途で分け、公開版では機密情報を除去またはマスキングする運用を導入する。\n- レポート生成スクリプトにテンプレート化（例：Jinja2 等）を導入し、自動的に環境変数から曖昧化された情報を挿入する。\n- 最新の実行日時や成果物へのリンクなどはCI/CDパイプラインで自動更新し、手動更新による誤記載を防止する。",
  "model_used": "gpt-5-codex"
}