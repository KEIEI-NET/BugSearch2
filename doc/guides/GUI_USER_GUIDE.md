# BugSearch2 GUI Control Center - ユーザーガイド

*バージョン: v1.0.4 (Phase 8.4対応)*
*最終更新: 2025年10月14日*

## 📚 概要

BugSearch2 GUI Control Centerは、コマンドライン操作なしでBugSearch2の全機能を使用できる統合GUIアプリケーションです。

### 主要機能

- **プロセス起動**: ワンクリックでジョブを開始
- **リアルタイム監視**: 実行中のジョブとログを監視
- **一時停止/再開**: プロセスの一時停止と再開
- **キュー管理**: 複数ジョブの並列実行とスケジューリング
- **状態永続化**: アプリ再起動後も状態を復元

---

## 🚀 インストール

### 1. 依存パッケージのインストール

```bash
# GUI専用パッケージ
pip install -r requirements_gui.txt

# または個別インストール
pip install customtkinter psutil
```

### 2. アプリケーション起動

```bash
python gui_main.py
```

---

## 📖 基本的な使い方

### メインウィンドウ

```
┌─────────────────────────────────────────────────────────┐
│ BugSearch2 Control Center v1.0.0                        │
├─────────────────────────────────────────────────────────┤
│ [📁 File] [❓ Help]                                     │
├─────────────────────────────────────────────────────────┤
│ [🚀 起動] [📊 監視] [⚙ 設定] [📜 履歴]                   │
│                                                         │
│ ... タブコンテンツ ...                                   │
│                                                         │
├─────────────────────────────────────────────────────────┤
│ Ready                                                   │
└─────────────────────────────────────────────────────────┘
```

### タブ構成

1. **🚀 起動タブ**: ジョブの起動
2. **📊 監視タブ**: 実行中ジョブとログの監視
3. **⚙ 設定タブ**: アプリケーション設定
4. **📜 履歴タブ**: 過去のジョブ履歴

---

## 🚀 起動タブ

### Context7統合分析（Phase 3: 複数トピック対応）

最も簡単な方法：技術スタックを指定して完全自動分析

```
┌─────────────────────────────────────────────┐
│ Context7統合分析 (--auto-run)               │
│                                             │
│ 技術スタック: [react    ▼]                  │
│                                             │
│ 分析トピック選択（複数選択可）:              │
│ ┌─────────────────────────────────────────┐ │
│ │ ☑ Security              ☑ Performance  │ │
│ │ ☐ Best Practices        ☐ Error Handle │ │
│ │ ☐ Testing               ☐ Accessibility│ │
│ │ ☐ Optimization          ☐ Architecture │ │
│ │ ☐ Design Patterns       ☐ Styling      │ │
│ │ ☐ State Management      ☐ Routing      │ │
│ │ ☐ Deployment            ☐ Monitoring   │ │
│ │ ☐ API Integration       ☐ Data Valid   │ │
│ └─────────────────────────────────────────┘ │
│                                             │
│ [▶ 起動]                                    │
└─────────────────────────────────────────────┘
```

**実行内容**:
1. Context7から技術仕様取得
2. カスタムルールYAML生成（選択されたトピックに特化）
3. YAML検証（エラーあればAI修正）
4. インデックス作成
5. AI分析実行
6. レポート生成

#### 📋 利用可能な16のトピックカテゴリ（Phase 3新機能）

トピックは**2列×8行のグリッドレイアウト**で表示されます。複数選択することで、それらのトピックを組み合わせた包括的な分析が可能です。

| 左列（1-8行） | 右列（9-16行） |
|------------|--------------|
| **Security** - セキュリティ問題 | **Performance** - パフォーマンス最適化 |
| **Best Practices** - ベストプラクティス | **Error Handling** - エラー処理 |
| **Testing** - テスト戦略 | **Accessibility** - アクセシビリティ |
| **Optimization** - コード最適化 | **Architecture** - アーキテクチャ設計 |
| **Design Patterns** - デザインパターン | **Styling** - スタイリング |
| **State Management** - 状態管理 | **Routing** - ルーティング |
| **Deployment** - デプロイメント | **Monitoring** - モニタリング |
| **API Integration** - API統合 | **Data Validation** - データ検証 |

#### 🎯 トピック選択の使い方

**単一トピック分析**:
- 1つのチェックボックスを選択（例: Security）
- → セキュリティに特化した深い分析

**複数トピック分析（Phase 3新機能）**:
- 複数のチェックボックスを選択（例: Security + Performance + Testing）
- → 選択したトピック全てをカバーする包括的な分析
- → Context7から各トピックの最新ベストプラクティスを取得

**全般分析**:
- トピックを何も選択しない
- → 技術スタック全般の包括的な分析

#### 💡 推奨トピックの組み合わせ

**セキュリティ重視**:
- ☑ Security
- ☑ Error Handling
- ☑ Data Validation

**パフォーマンス重視**:
- ☑ Performance
- ☑ Optimization
- ☑ Monitoring

**コード品質重視**:
- ☑ Best Practices
- ☑ Design Patterns
- ☑ Testing

**本番環境準備**:
- ☑ Security
- ☑ Performance
- ☑ Deployment
- ☑ Monitoring

### インデックス作成

コードベースのインデックスを作成

```
┌─────────────────────────────────────────────┐
│ インデックス作成                             │
│                                             │
│ [▶ 起動]                                    │
└─────────────────────────────────────────────┘
```

**実行内容**:
```bash
python codex_review_severity.py index
```

### AI分析実行

高深刻度ファイルに対するAI詳細分析

```
┌─────────────────────────────────────────────┐
│ AI分析実行                                   │
│                                             │
│ [▶ 起動]                                    │
└─────────────────────────────────────────────┘
```

**実行内容**:
```bash
python codex_review_severity.py advise --all
```

### 改善コード適用

AI生成の改善コードを自動適用

```
┌─────────────────────────────────────────────┐
│ 改善コード適用                               │
│                                             │
│ [▶ 起動]                                    │
└─────────────────────────────────────────────┘
```

**実行内容**:
```bash
python apply_improvements_from_report.py reports/latest.md
```

---

## 📊 監視タブ

### 実行中ジョブ

```
┌─────────────────────────────────────────────────────┐
│ 実行中のジョブ                                       │
├─────────────────────────────────────────────────────┤
│ ▶ Job#001: React分析 (AI修正中...)                  │
│   ████████████░░░░░░░░░░ 65% [⏸][⏹]              │
│   CPU: 15% | メモリ: 450MB | 経過: 2m 30s           │
│                                                     │
│ ▶ Job#002: インデックス作成                          │
│   ██████████████████████ 100% [✓]                  │
│   完了: 150ファイル | 3m 10s                         │
└─────────────────────────────────────────────────────┘
```

### リアルタイムログ

```
┌─────────────────────────────────────────────────────┐
│ リアルタイムログ                      [🔍][💾]       │
├─────────────────────────────────────────────────────┤
│ [15:30:45] INFO: Starting Context7 integration...    │
│ [15:30:47] INFO: Resolving library ID for 'react'    │
│ [15:30:50] SUCCESS: Retrieved docs for React 18.x    │
│ [15:30:51] INFO: Generating YAML configuration...    │
│ [15:30:52] WARNING: Validation error in rule #3      │
│ [15:30:55] INFO: Attempting AI fix (1/5)...          │
│ [15:31:00] SUCCESS: YAML validation passed           │
└─────────────────────────────────────────────────────┘
```

### ジョブ制御ボタン

- **⏸ 一時停止**: プロセスをサスペンド（メモリ状態を保持）
- **▶ 再開**: サスペンド中のプロセスを再開
- **⏹ 停止**: プロセスを終了

---

## ⚙ 設定タブ

### テーマ設定

```
テーマ:
[dark ▼]  # or light
```

- **Dark**: ダークモード（デフォルト）
- **Light**: ライトモード

### 並列実行数

```
最大並列実行数:
[━━━●━━━━━━] 3
現在: 3
```

スライダーで1〜10の範囲で調整

### デフォルト設定（Phase 8.4）

起動タブのチェックボックスのデフォルト値を管理できます。

```
デフォルト設定:

┌─────────────────────────────────────────────────────┐
│ 起動タブのチェックボックスのデフォルト値を管理します   │
│                                                     │
│ 【Context7統合分析】                                │
│                                                     │
│   技術スタック: react, angular                      │
│   トピック: security, performance, best-practices   │
│                                                     │
│ 【統合テスト】                                       │
│                                                     │
│   プロジェクトタイプ: react, angular, vue           │
│   トピック: security, performance, best-practices,  │
│             error-handling, testing                │
│   最大ファイルサイズ: 4 MB                          │
│   ワーカー数: 4                                     │
│                                                     │
│ [設定ファイルを開く] [表示を更新] [デフォルトに戻す] │
└─────────────────────────────────────────────────────┘
```

**ボタン操作**:

- **[設定ファイルを開く]**: `config/integration_test_defaults.yml`をエディタで開く
- **[表示を更新]**: 設定ファイル編集後、GUIに変更を反映
- **[デフォルトに戻す]**: 工場出荷時のデフォルト設定に戻す（確認ダイアログあり）

**設定ファイル構造** (`config/integration_test_defaults.yml`):
```yaml
version: "1.0.0"

# Context7統合分析のデフォルト設定
context7:
  default_tech_stacks:
    - react
    - angular
  default_topics:
    - security
    - performance
    - best-practices

# 統合テストのデフォルト設定
integration_test:
  default_project_types:
    - react
    - angular
    - vue
  default_topics:
    - security
    - performance
    - best-practices
    - error-handling
    - testing
  default_max_file_mb: 4
  default_worker_count: 4
```

**使用例**:

1. **デフォルト値のカスタマイズ**:
   - [設定ファイルを開く]ボタンをクリック
   - YAMLファイルを編集（例: `default_topics`に`accessibility`を追加）
   - ファイルを保存
   - [表示を更新]ボタンをクリック
   - 起動タブを開くと、新しいデフォルトでチェックボックスが初期化される

2. **リセット**:
   - [デフォルトに戻す]ボタンをクリック
   - 確認ダイアログで[OK]を選択
   - 設定ファイルが工場出荷時の状態に戻る

**CUI統合**:

CUIコマンド実行時にも同じデフォルト設定が適用されます:

```bash
# 引数省略時はデフォルト設定を使用
python -m core.integration_test_engine

# 出力例:
# [INFO] デフォルト設定からproject-type取得: react
# [INFO] デフォルト設定からtopics取得: security, performance
# [INFO] デフォルト設定からmax-file-mb取得: 4
# [INFO] デフォルト設定からworker-count取得: 4

# 引数指定でデフォルトを上書き
python -m core.integration_test_engine --project-type angular --topics security
```

---

## 📜 履歴タブ

過去のジョブ実行履歴を表示

```
┌─────────────────────────────────────────────────────┐
│ 2025-10-12 15:30 | React分析 | ✓ 完了 | 5m 20s      │
│ 2025-10-12 14:15 | Index作成 | ✓ 完了 | 2m 15s      │
│ 2025-10-12 13:45 | Vue分析   | ✗ 失敗 | 1m 30s      │
└─────────────────────────────────────────────────────┘
```

**[🗑 履歴クリア]** ボタンで履歴を削除

### 📊 履歴統計（Phase 4.3）

履歴タブ下部に統計情報が表示されます：

```
┌─────────────────────────────────────────────────────┐
│ 統計情報                                             │
│                                                     │
│ 総ジョブ数:        25                               │
│ 成功数:            20 (80.0%)                       │
│ 失敗数:            5 (20.0%)                        │
│ 合計実行時間:      2時間 15分                        │
│ 平均実行時間:      5分 24秒                          │
└─────────────────────────────────────────────────────┘
```

### 📝 レポート選択ダイアログ（Phase 4.3）

完了したジョブをダブルクリックすると、生成されたレポートを選択して開くことができます：

```
┌────────────────────────────────────┐
│ レポートを選択                      │
│                                    │
│ ○ reports/analysis_react.md        │
│ ○ reports/complete_analysis.md    │
│ ○ reports/security_scan.md        │
│                                    │
│      [キャンセル]    [開く]        │
└────────────────────────────────────┘
```

**対応エディタ**: VS Code, Notepad++, メモ帳（自動検出）

### 🔄 終了確認ダイアログ（Phase 4.3）

実行中ジョブがある状態でアプリを閉じようとすると確認ダイアログが表示されます：

```
┌────────────────────────────────────┐
│ 実行中のジョブがあります              │
│                                    │
│ 3個のジョブが実行中です。             │
│ 終了しますか？                      │
│                                    │
│ [キャンセル]  [強制終了]  [停止して終了] │
└────────────────────────────────────┘
```

- **キャンセル**: アプリを閉じない
- **強制終了**: ジョブを残して終了（危険）
- **停止して終了**: 全ジョブ停止後に終了（推奨）

---

## 📁 ファイルメニュー（Phase 4.4）

メインメニューバーの**[📁 File]**から以下の機能にアクセスできます：

### 設定ファイルを開く

```
File → 設定ファイルを開く
```

`.bugsearch.yml`をデフォルトエディタで開きます。

**用途**: プロジェクト設定の手動編集

### レポートフォルダを開く

```
File → レポートフォルダを開く
```

`reports/`ディレクトリをエクスプローラー/Finderで開きます。

**用途**: 生成されたレポートファイルへのアクセス

### 状態エクスポート

```
File → 状態エクスポート
```

現在のアプリ状態（設定、ウィンドウ位置、ジョブ履歴）をJSONファイルにエクスポートします。

**エクスポート内容**:
- ウィンドウサイズと位置
- アプリケーション設定（テーマ、並列数等）
- ジョブ履歴
- カスタムデータ

**ファイル形式**:
```json
{
  "version": "1.0.0",
  "exported_at": "2025-10-13T10:00:00",
  "window": { "width": 1200, "height": 800, ... },
  "settings": { "theme": "dark", ... },
  "job_history": { ... }
}
```

### 状態インポート

```
File → 状態インポート
```

エクスポートしたJSONファイルから状態を復元します。

**使用例**:
1. 別のマシンに設定を移行
2. バックアップから復元
3. チーム間で設定を共有

**注意**: インポート後、アプリが自動的に再起動します。

### 終了

```
File → 終了
または
Alt+F4 / Cmd+Q
```

アプリケーションを終了します（実行中ジョブがあれば確認ダイアログ表示）。

---

## 🎯 使用シナリオ

### シナリオ1: 新規プロジェクトの完全分析

1. **起動タブ**を開く
2. **Context7統合分析**の[▶ 起動]をクリック
3. **監視タブ**に切り替え
4. リアルタイムログで進捗を確認
5. 完了後、`reports/`ディレクトリでレポートを確認

**所要時間**: 約5〜10分（プロジェクトサイズによる）

### シナリオ2: 段階的な分析

1. **インデックス作成**を起動
2. 完了を待つ（2〜3分）
3. **AI分析実行**を起動
4. 結果を確認

**メリット**: 各段階で結果を確認できる

### シナリオ3: 複数プロジェクトの並列分析

1. **設定タブ**で並列実行数を5に設定
2. **起動タブ**で5つのジョブを順次追加
3. **監視タブ**で全ジョブの進捗を確認

**メリット**: 時間を大幅に短縮

---

## 🔧 トラブルシューティング

### ジョブが起動しない

**原因**: 並列実行数上限に達している

**解決策**:
1. 監視タブで実行中ジョブを確認
2. 不要なジョブを停止
3. または設定タブで並列実行数を増やす

### ログが表示されない

**原因**: ログ収集が開始されていない

**解決策**:
1. アプリを再起動
2. ジョブを再実行

### プロセスが停止できない

**原因**: プロセスがハングしている

**解決策**:
1. [⏹ 停止]ボタンを押す
2. 10秒待機（自動的にSIGKILL）
3. それでも停止しない場合はタスクマネージャーから強制終了

### 状態が保存されない

**原因**: `.gui_app_state.json`への書き込み権限がない

**解決策**:
```bash
# 権限を確認
ls -la .gui_app_state.json

# 権限を付与（Unix/Mac）
chmod 644 .gui_app_state.json
```

---

## ⌨ キーボードショートカット

| ショートカット | 機能 |
|------------|------|
| `Ctrl+N` | 新しいジョブ（未実装） |
| `Ctrl+P` | 一時停止/再開（未実装） |
| `Ctrl+S` | 設定保存（自動保存） |
| `Ctrl+L` | ログクリア（未実装） |
| `F5` | 更新（未実装） |

*注: v1.0.0では一部未実装*

---

## 📊 パフォーマンスのヒント

### 推奨設定

| 項目 | 小規模 | 中規模 | 大規模 |
|-----|--------|--------|--------|
| **ファイル数** | <1,000 | 1,000-10,000 | >10,000 |
| **並列実行数** | 1-2 | 3-5 | 5-10 |
| **ログバッファ** | 5,000 | 10,000 | 20,000 |

### メモリ使用量

| コンポーネント | 使用量 |
|------------|--------|
| GUI本体 | 50-100MB |
| プロセス1つ | 100-300MB |
| ログバッファ | 10-50MB |

**合計**: 約200-500MB（並列実行数3の場合）

---

## 🔗 関連ドキュメント

- [BugSearch2 README](../../README.md)
- [技術仕様書](../TECHNICAL.md)
- [Context7統合ガイド](./CONTEXT7_INTEGRATION_GUIDE.md)
- [Phase 8計画書](../PHASE8_PLAN.md)

---

## 🆘 サポート

### 問題報告

GitHubでissueを作成:
- リポジトリ: `KEIEI-NET/BugSearch2`
- テンプレート: Bug Report

### 含めるべき情報

1. BugSearch2バージョン
2. OS情報（Windows/Mac/Linux）
3. Pythonバージョン
4. エラーメッセージ
5. 再現手順

---

*最終更新: 2025年10月14日*
*バージョン: v1.0.4 (Phase 8.4対応)*

**更新履歴:**
- v1.0.4 (2025年10月14日): **Phase 8.4実装完了 (@perfect品質達成)** - チェックボックスデフォルト設定システム実装、設定タブにデフォルト設定UI追加（表示/編集/リフレッシュ/リセット機能）、CUI統合（オプション引数のデフォルト値対応）、設定ファイル管理ガイド追加、全15テスト合格（15/15成功）
- v1.0.3 (2025年10月13日): **Phase 3実装完了 (@tdd品質達成)** - 複数トピック対応（GUI + CLI）、16トピックカテゴリの2列×8行グリッドレイアウト、トピック選択詳細ガイド追加、全22テスト合格（Context7統合10/10 + GUIグリッド12/12）
- v1.0.2 (2025年10月13日): Phase 4.3/4.4機能追加（履歴統計、レポート選択ダイアログ、終了確認、ファイルメニュー、状態エクスポート/インポート）
- v1.0.0 (2025年10月12日): 初版作成、Phase 4.1完了
