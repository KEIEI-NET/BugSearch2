# 変更履歴 - バージョン 3.0.0

## リリース日: 2025年9月28日

## 主要な変更点

### 🆕 新機能

#### 1. GPT-5-Codex完全対応
- **Responses API統合** (`/v1/responses`)
  - OpenAI公式クライアントの`responses.create()`メソッド実装
  - コード特化の高精度分析
  - `reasoning.effort: "high"`による詳細解析

#### 2. デュアルAPIアーキテクチャ
- **自動API選択機能**
  - GPT-5-Codex → Responses API
  - GPT-4o/GPT-5系 → Chat Completions API
  - 環境変数での簡単切り替え

#### 3. 高度なエラーハンドリング
- **3段階リトライメカニズム**
  - パラメータ自動調整
  - 空レスポンス対策
  - 詳細なエラー診断ログ

### 🔧 改善点

#### 1. Windows環境対応強化
- **CP932エンコーディング完全対応**
  - 全絵文字文字の削除
  - 文字化け防止実装

#### 2. レスポンス処理の統一化
- **複数のレスポンス構造に対応**
  - 直接フィールドアクセス
  - ネストされた構造の解析
  - 自動フォーマット判定

#### 3. フォールバック機能
- **自動モデル切り替え**
  - GPT-5-Codex失敗時 → gpt-4o
  - APIエラー時の継続処理
  - ユーザー透過的な処理

### 📝 ドキュメント更新

- `README.md`: v3.0.0対応、モデル対応表追加
- `GPT5_MIGRATION.md`: 完全な移行ガイド
- `GPT5_STATUS.md`: 実装ステータスと動作確認結果
- `TECHNICAL_v3.md`: 技術詳細文書
- Mermaidフロー図: API選択フローの追加

### 🧪 テスト追加

- `test_gpt5_codex_official.py`: 公式形式での動作確認
- `test_empty_response_fix.py`: 空レスポンス対策テスト
- 実際の本番環境での動作確認完了

## 破壊的変更

なし（後方互換性維持）

## 既知の問題

1. **GPT-5/GPT-5-mini/GPT-5-nano**
   - APIがまだ一般公開されていない
   - 実装は完了、公開待ち状態

## アップグレード方法

1. 最新版を取得
```bash
git pull origin main
```

2. `.env`ファイルを更新
```env
OPENAI_MODEL=gpt-5-codex  # 新機能を試す
OPENAI_MODEL=gpt-4o       # 安定版（デフォルト推奨）
```

3. 実行
```bash
py codex_review_severity.py advise --topk 10
```

## パフォーマンス比較

| モデル | v2.1.0 | v3.0.0 | 改善率 |
|--------|--------|--------|--------|
| gpt-4o | 5秒/ファイル | 5秒/ファイル | - |
| gpt-5-codex | 未対応 | 3-5秒/ファイル | 新規 |

## 貢献者

- OpenAI GPT-5-Codex APIドキュメント提供
- コミュニティからのフィードバック

## 次期バージョン予定

- v3.1.0: ストリーミングレスポンス対応
- v3.2.0: バッチ処理最適化
- v4.0.0: カスタムモデル対応

---
最終更新: 2025-09-28 18:40