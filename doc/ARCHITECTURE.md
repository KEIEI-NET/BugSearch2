# ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

*ãƒãƒ¼ã‚¸ãƒ§ãƒ³: v4.2.2 (Phase 3.3å®Œäº†)*
*æœ€çµ‚æ›´æ–°: 2025å¹´10æœˆ12æ—¥ JST*

## æ¦‚è¦

Codex Review ã¯ã€é™çš„ã‚³ãƒ¼ãƒ‰è§£æã¨AIåˆ†æã‚’çµ„ã¿åˆã‚ã›ãŸå¤šå±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã€**ã‚³ãƒ¼ãƒ‰å“è³ªã‚¹ã‚³ã‚¢100ç‚¹ã‚’é”æˆ**ã—ãŸã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚v4.2.2ã§ã¯Phase 3.3å®Œäº†ã«ã‚ˆã‚Šã€**10å€‹ã®YAMLãƒ«ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ **ã¨**4ã‚«ãƒ†ã‚´ãƒªå®Œå…¨ã‚µãƒãƒ¼ãƒˆ**ã‚’å®Ÿç¾ã—ã€æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å¯¾å¿œå‹è§£æãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚

## ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹                    â”‚
â”‚                      (CLI: codex_review_severity.py)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                               â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å±¤   â”‚            â”‚   åˆ†æåˆ¶å¾¡å±¤     â”‚
         â”‚  - ãƒ•ã‚¡ã‚¤ãƒ«åé›†   â”‚            â”‚  - ãƒãƒƒãƒå‡¦ç†    â”‚
         â”‚  - ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æ¤œå‡º  â”‚            â”‚  - ä¸¦åˆ—åˆ¶å¾¡     â”‚
         â”‚  - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ â”‚            â”‚  - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç† â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                               â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   è§£æã‚¨ãƒ³ã‚¸ãƒ³å±¤                   â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚  ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹è§£æ  â”‚   SOLIDåŸå‰‡æ¤œå‡º  â”‚  AIåˆ†æ    â”‚
         â”‚  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£   â”‚   - 5åŸå‰‡ãƒã‚§ãƒƒã‚¯ â”‚  - GPT     â”‚
         â”‚  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹  â”‚   - è¨€èªåˆ¥å¯¾å¿œ   â”‚  - Claude  â”‚
         â”‚  - ã‚³ãƒ¼ãƒ‰å“è³ª     â”‚   - Angularæ¤œå‡º  â”‚  - Fallbackâ”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚    ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå±¤     â”‚
                           â”‚  - Markdownå‡ºåŠ›      â”‚
                           â”‚  - é‡è¦åº¦ã‚½ãƒ¼ãƒˆ      â”‚
                           â”‚  - çµ±è¨ˆæƒ…å ±ç”Ÿæˆ     â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¨­è¨ˆåŸå‰‡

### 1. å“è³ª100ç‚¹é”æˆã®è¨­è¨ˆåˆ¤æ–­

**v3.4ã§ã®ä¸»è¦ãªè¨­è¨ˆåˆ¤æ–­:**
1. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**: å…¨å…¥åŠ›ã®æ¤œè¨¼ã€ãƒ‘ã‚¹æ­£è¦åŒ–ã€APIã‚­ãƒ¼ãƒã‚¹ã‚­ãƒ³ã‚°
2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: ãƒ—ãƒªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã€ä¸¦åˆ—å‡¦ç†
3. **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ä½¿ç”¨ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
4. **ã‚¨ãƒ©ãƒ¼å›å¾©**: å€‹åˆ¥ã‚¿ã‚¹ã‚¯å¤±æ•—ã®ç¶™ç¶šå‡¦ç†ã€è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
5. **ä¿å®ˆæ€§**: å®šæ•°åŒ–ã€å‹ãƒ’ãƒ³ãƒˆã€DRYåŸå‰‡

### 2. 2æ®µéšãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆ

```
[Index Phase] â†’ [.advice_index.jsonl] â†’ [Advise Phase]
     â†“                                        â†“
ãƒ•ã‚¡ã‚¤ãƒ«åé›†                              ãƒ«ãƒ¼ãƒ«åˆ†æ
ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æ¤œå‡º                            AIåˆ†æ
ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ                            ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
```

**è¨­è¨ˆç†ç”±:**
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å†åˆ©ç”¨æ€§
- æ®µéšçš„ãªå‡¦ç†ã«ã‚ˆã‚‹å®‰å®šæ€§
- å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¯¾å¿œï¼ˆå·®åˆ†æ›´æ–°ï¼‰

## ğŸ“¦ ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

### Phase 3.3æ–°è¦è¿½åŠ : YAMLãƒ«ãƒ¼ãƒ«ã‚¨ãƒ³ã‚¸ãƒ³

**v4.2.2ã§å®Œæˆã—ãŸãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹è§£æã‚·ã‚¹ãƒ†ãƒ :**

```
rules/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ database/          (3ãƒ«ãƒ¼ãƒ«)
â”‚   â”‚   â”œâ”€â”€ n-plus-one.yml
â”‚   â”‚   â”œâ”€â”€ select-star.yml
â”‚   â”‚   â””â”€â”€ multiple-join.yml
â”‚   â”œâ”€â”€ security/          (3ãƒ«ãƒ¼ãƒ«)
â”‚   â”‚   â”œâ”€â”€ sql-injection.yml
â”‚   â”‚   â”œâ”€â”€ xss-vulnerability.yml
â”‚   â”‚   â””â”€â”€ float-money.yml
â”‚   â”œâ”€â”€ solid/             (2ãƒ«ãƒ¼ãƒ«)
â”‚   â”‚   â”œâ”€â”€ large-class.yml
â”‚   â”‚   â””â”€â”€ large-interface.yml
â”‚   â””â”€â”€ performance/       (2ãƒ«ãƒ¼ãƒ«)
â”‚       â”œâ”€â”€ memory-leak.yml
â”‚       â””â”€â”€ goroutine-leak.yml
```

**ä¸»è¦æ©Ÿèƒ½:**
- `load_all_rules()`: å…¨YAMLãƒ«ãƒ¼ãƒ«ã®å†å¸°çš„èª­ã¿è¾¼ã¿
- `group_rules_by_category()`: ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®ãƒ«ãƒ¼ãƒ«ç®¡ç†
- `adjust_severity_by_tech_stack()`: æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ä¾å­˜ã®æ·±åˆ»åº¦èª¿æ•´

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å¯¾å¿œä¾‹:**
- Elasticsearchä½¿ç”¨æ™‚: N+1å•é¡Œã®æ·±åˆ»åº¦ 10â†’7ã«è»½æ¸›
- ORMä½¿ç”¨æ™‚: SELECT *ã®æ·±åˆ»åº¦ã‚’è‡ªå‹•èª¿æ•´
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ä½¿ç”¨æ™‚: XSSã®æ·±åˆ»åº¦ã‚’é©åˆ‡ã«èª¿æ•´

### 1. CLIå±¤ï¼ˆã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰

**è²¬å‹™**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒãƒ³ãƒ‰ã®è§£æã¨å®Ÿè¡Œåˆ¶å¾¡

**ä¸»è¦æ©Ÿèƒ½**:
- `index`: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆ
- `vectorize`: TF-IDFãƒ™ã‚¯ãƒˆãƒ«åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- `query`: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢
- `advise`: è‡ªå‹•åˆ†æã¨æ¨å¥¨
- `analyze`: å±é™ºãƒ•ã‚¡ã‚¤ãƒ«æŠ½å‡º

**v3.4.0æ”¹å–„ç‚¹**:
- CLIå¼•æ•°æ¤œè¨¼å¼·åŒ–
- è©³ç´°ãªãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- ä½¿ç”¨ä¾‹ã®è¿½åŠ 

### 2. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å±¤

**è²¬å‹™**: ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®åé›†ã¨å‰å‡¦ç†

**v3.4ã®æ”¹å–„ç‚¹:**
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãªã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°èª­ã¿è¾¼ã¿ï¼ˆ94%ãƒ¡ãƒ¢ãƒªå‰Šæ¸›ï¼‰
- å·®åˆ†æ›´æ–°ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
- MD5ãƒãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹å¤‰æ›´æ¤œå‡º

**ä¸»è¦æ©Ÿèƒ½**:
```python
def index_files(root_dir, options):
    # ãƒ•ã‚¡ã‚¤ãƒ«åé›†
    files = collect_files(root_dir, options.exclude_langs)

    # ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¤œå‡ºï¼ˆæ—¥æœ¬èªå¯¾å¿œï¼‰
    for file in files:
        encoding = detect_encoding(file)  # UTF-8, Shift_JIS, CP932, EUC-JP
        content = read_file(file, encoding)

        # MD5ãƒãƒƒã‚·ãƒ¥ç”Ÿæˆï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”¨ï¼‰
        content_hash = hashlib.md5(content.encode()).hexdigest()

def load_index_stream(path: str) -> Generator[dict, None, None]:
    """å¤§è¦æ¨¡ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°èª­ã¿è¾¼ã¿ï¼ˆv3.4æ–°æ©Ÿèƒ½ï¼‰"""
    with open(path, 'r', encoding='utf-8') as f:
        for line in f:
            yield json.loads(line)

    # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
    metadata = {
        'hash': calculate_md5(content),
        'size': file_size,
        'language': detect_language(file),
        'timestamp': modification_time
    }

    # JSONLãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
    save_to_jsonl(file_data)
```

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
    "file": "src/example.cs",
    "hash": "d41d8cd98f00b204e9800998ecf8427e",
    "size": 1024,
    "lang": "csharp",
    "content": "public class Example { ... }",
    "timestamp": "2025-01-02T12:00:00Z"
}
```

### 3. è§£æã‚¨ãƒ³ã‚¸ãƒ³å±¤

#### 3.1 ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹è§£æ

**v3.4.0ãƒ—ãƒªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```python
COMPILED_PATTERNS = {
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ15å€‹ï¼‰
    'php_sql_injection': re.compile(r'\$_(GET|POST|REQUEST)\[.{1,100}\].*?(mysql_query|mysqli_query|pg_query)', re.IGNORECASE),
    'php_xss': re.compile(r'echo\s+\$_(GET|POST|REQUEST)\[', re.IGNORECASE),
    'php_cmd_injection': re.compile(r'(system|exec|shell_exec|passthru)\s*\(\s*\$', re.IGNORECASE),

    # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ10å€‹ï¼‰
    'n_plus_one': re.compile(r'(for|foreach|while).{1,500}(SELECT|select)', re.DOTALL),
    'select_star': re.compile(r'SELECT\s+\*\s+FROM', re.IGNORECASE),

    # SOLIDåŸå‰‡ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ20å€‹ï¼‰
    'large_class': re.compile(r'class\s+\w+\s*{'),
    'switch_statement': re.compile(r'switch\s*\('),
    'not_implemented': re.compile(r'throw\s+new\s+NotImplementedException'),

    # Angularå›ºæœ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ10å€‹ï¼‰
    'constructor_logic': re.compile(r'constructor\s*\([^)]{0,500}\)\s*{[^}]{0,500}', re.DOTALL),
    'change_detection': re.compile(r'@Component\s*\([^)]*\)'),
}
```

**æ¤œå‡ºã‚«ãƒ†ã‚´ãƒª**:
1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å•é¡Œ** (é‡è¦åº¦: 10-15)
   - N+1å•é¡Œ
   - SELECT *
   - å¤šé‡JOIN
   - å¤§OFFSET

2. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œ** (é‡è¦åº¦: 8-10)
   - SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³
   - XSSè„†å¼±æ€§
   - ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³
   - ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«

3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œ** (é‡è¦åº¦: 5-7)
   - éåŠ¹ç‡ãªãƒ«ãƒ¼ãƒ—
   - ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯
   - ä¸è¦ãªå†è¨ˆç®—

4. **ã‚³ãƒ¼ãƒ‰å“è³ªå•é¡Œ** (é‡è¦åº¦: 3-5)
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä¸è¶³
   - ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼
   - é‡è¤‡ã‚³ãƒ¼ãƒ‰

#### 3.2 SOLIDåŸå‰‡æ¤œå‡º

**v3.4.0å®šæ•°åŒ–ã•ã‚ŒãŸé–¾å€¤**:
```python
SOLID_THRESHOLDS = {
    'class_lines': 500,              # S: å˜ä¸€è²¬ä»»
    'class_methods': 20,             # S: å˜ä¸€è²¬ä»»
    'interface_methods': 7,          # I: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åˆ†é›¢
    'interface_max_methods': 10,     # I: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åˆ†é›¢
    'struct_fields': 15,             # S: å˜ä¸€è²¬ä»»ï¼ˆGoï¼‰
    'switch_count': 3,               # O: ã‚ªãƒ¼ãƒ—ãƒ³ãƒ»ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰
    'global_vars_count': 5,          # D: ä¾å­˜æ€§é€†è»¢
    'constructor_logic_lines': 10,   # Angularå›ºæœ‰
    'method_lines': 50,              # ä¸€èˆ¬çš„ãªãƒ¡ã‚½ãƒƒãƒ‰
    'file_lines': 1000,              # ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“
    'dependency_count': 10,          # D: ä¾å­˜æ€§é€†è»¢
    'parameter_count': 7             # ä¸€èˆ¬çš„ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
}
```

**è¨€èªåˆ¥å®Ÿè£…**:
```python
def scan_solid_csharp(text):
    results = []

    # S: Single Responsibility
    if count_lines(text) > SOLID_THRESHOLDS['class_lines']:
        results.append("SOLID(S): å·¨å¤§ã‚¯ãƒ©ã‚¹")

    # O: Open/Closed
    switch_count = len(COMPILED_PATTERNS['switch_statement'].findall(text))
    if switch_count > SOLID_THRESHOLDS['switch_count']:
        results.append("SOLID(O): switchæ–‡å¤šç”¨")

    # L: Liskov Substitution
    if COMPILED_PATTERNS['not_implemented'].search(text):
        results.append("SOLID(L): NotImplementedException")

    # I: Interface Segregation
    interfaces = _check_large_interface(text, 'interface')
    results.extend(interfaces)

    # D: Dependency Inversion
    if COMPILED_PATTERNS['concrete_instantiation'].search(text):
        results.append("SOLID(D): å…·è±¡ã‚¯ãƒ©ã‚¹ç›´æ¥ç”Ÿæˆ")

    return results
```

#### 3.3 AIåˆ†æå±¤

**ãƒãƒ«ãƒãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å¯¾å¿œ**:
```python
class AIAnalyzer:
    def __init__(self):
        self.providers = {
            'anthropic': AnthropicProvider(),
            'openai': OpenAIProvider()
        }
        self.fallback_chain = ['anthropic', 'openai']

    async def analyze(self, code, severity):
        # å±é™ºåº¦ã«å¿œã˜ãŸãƒ¢ãƒ‡ãƒ«é¸æŠ
        model = self.select_model(severity)

        for provider in self.fallback_chain:
            try:
                result = await self.providers[provider].analyze(
                    code, model, reasoning_effort='high' if severity > 15 else None
                )
                if result:
                    return result
            except Exception as e:
                log.warning(f"{provider} failed: {e}")
                continue

        return None

    def select_model(self, severity):
        if severity >= 15:
            return 'gpt-5-codex'  # ã¾ãŸã¯ claude-opus-4-1
        elif severity >= 10:
            return 'gpt-4o'       # ã¾ãŸã¯ claude-sonnet-4-5
        else:
            return 'gpt-4o-mini'  # ã¾ãŸã¯ claude-sonnet-4-1
```

### 4. ä¸¦åˆ—å‡¦ç†å±¤

**ThreadPoolExecutorå®Ÿè£…**:
```python
def parallel_analysis(files, config):
    with ThreadPoolExecutor(max_workers=10) as executor:
        # ãƒãƒƒãƒåˆ†å‰²
        batches = create_batches(files, batch_size=50)

        # ä¸¦åˆ—å®Ÿè¡Œ
        futures = []
        for batch in batches:
            future = executor.submit(analyze_batch, batch)
            futures.append(future)

        # çµæœåé›†
        results = []
        for future in concurrent.futures.as_completed(futures):
            try:
                result = future.result(timeout=60)
                results.extend(result)
            except TimeoutError:
                log.error("Batch timeout")

    return results
```

### 5. ã‚­ãƒ£ãƒƒã‚·ãƒ¥å±¤

**MD5ãƒãƒƒã‚·ãƒ¥ãƒ™ãƒ¼ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥**:
```python
class CacheManager:
    def __init__(self, cache_dir='.cache/analysis'):
        self.cache_dir = Path(cache_dir)
        self.cache_dir.mkdir(exist_ok=True)

    def get_cache_key(self, file_path, content):
        # ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®MD5ãƒãƒƒã‚·ãƒ¥
        content_hash = hashlib.md5(content.encode()).hexdigest()
        # ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å«ã‚€ã‚­ãƒ¼ç”Ÿæˆ
        filename_safe = re.sub(r'[^\w\-_]', '_', file_path)
        return f"{filename_safe}_{content_hash}.json"

    def get(self, key):
        cache_file = self.cache_dir / key
        if cache_file.exists():
            with open(cache_file, 'r', encoding='utf-8') as f:
                return json.load(f)
        return None

    def set(self, key, value):
        cache_file = self.cache_dir / key
        with open(cache_file, 'w', encoding='utf-8') as f:
            json.dump(value, f, ensure_ascii=False, indent=2)
```

### 6. ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå±¤

**é‡è¦åº¦ã‚½ãƒ¼ãƒˆå®Ÿè£…**:
```python
def generate_report(results):
    # é‡è¦åº¦ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
    grouped = defaultdict(list)
    for result in results:
        severity = result['severity']
        if severity >= 15:
            grouped['critical'].append(result)
        elif severity >= 10:
            grouped['high'].append(result)
        elif severity >= 5:
            grouped['medium'].append(result)
        else:
            grouped['low'].append(result)

    # Markdownç”Ÿæˆ
    report = []
    report.append("# ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼åˆ†æãƒ¬ãƒãƒ¼ãƒˆ\n")
    report.append(f"*ç”Ÿæˆæ—¥æ™‚: {datetime.now(JST).strftime('%Yå¹´%mæœˆ%dæ—¥ %H:%M JST')}*\n")

    # çµ±è¨ˆæƒ…å ±
    report.append("## ğŸ“Š ã‚µãƒãƒªãƒ¼\n")
    report.append(f"- ğŸ”´ ç·Šæ€¥: {len(grouped['critical'])}ä»¶\n")
    report.append(f"- ğŸŸ  é«˜: {len(grouped['high'])}ä»¶\n")
    report.append(f"- ğŸŸ¡ ä¸­: {len(grouped['medium'])}ä»¶\n")
    report.append(f"- ğŸ”µ ä½: {len(grouped['low'])}ä»¶\n")

    # è©³ç´°çµæœ
    for severity_level in ['critical', 'high', 'medium', 'low']:
        if grouped[severity_level]:
            report.append(f"\n## {SEVERITY_LABELS[severity_level]}\n")
            for item in sorted(grouped[severity_level],
                             key=lambda x: x['severity'],
                             reverse=True):
                report.append(format_issue(item))

    return ''.join(report)
```

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 1. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆãƒ•ãƒ­ãƒ¼

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›
    â†“
ãƒ•ã‚¡ã‚¤ãƒ«æ¢ç´¢ï¼ˆos.walkï¼‰
    â†“
è¨€èªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    â†“
ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯ï¼ˆ--max-file-mbï¼‰
    â†“
ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¤œå‡ºï¼ˆchardetï¼‰
    â†“
ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª­ã¿è¾¼ã¿
    â†“
ãƒãƒƒã‚·ãƒ¥è¨ˆç®—ï¼ˆMD5ï¼‰
    â†“
JSONLãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿
    â†“
ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°
```

### 2. åˆ†æå®Ÿè¡Œãƒ•ãƒ­ãƒ¼

```
ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹èª­ã¿è¾¼ã¿
    â†“
é‡è¦åº¦è¨ˆç®—ï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ï¼‰
    â†“
ä¸Šä½Nä»¶æŠ½å‡ºï¼ˆ--topk ã¾ãŸã¯ --allï¼‰
    â†“
ä¸¦åˆ—ãƒãƒƒãƒåˆ†å‰²
    â†“
ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
    â†“ (ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹)
AI APIå‘¼ã³å‡ºã—
    â†“
çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜
    â†“
ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    â†“
Markdownãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 1. æ­£è¦è¡¨ç¾ãƒ—ãƒªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼ˆv3.4.0ï¼‰

**åŠ¹æœ**: 2-3å€ã®é«˜é€ŸåŒ–

```python
# Beforeï¼ˆv3.3.0ï¼‰
def check_pattern(text):
    if re.search(r'complex_pattern', text):  # æ¯å›ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
        return True

# Afterï¼ˆv3.4.0ï¼‰
COMPILED_PATTERNS = {
    'pattern': re.compile(r'complex_pattern')  # èµ·å‹•æ™‚ã«1å›ã®ã¿
}

def check_pattern(text):
    if COMPILED_PATTERNS['pattern'].search(text):  # é«˜é€Ÿ
        return True
```

### 2. ä¸¦åˆ—å‡¦ç†

**åŠ¹æœ**: 10å€ã®é«˜é€ŸåŒ–ï¼ˆ10ãƒ¯ãƒ¼ã‚«ãƒ¼ä¸¦åˆ—ï¼‰

```python
# è¨­å®š
PARALLEL_CONFIG = {
    'batch_size': 50,           # ãƒãƒƒãƒã‚µã‚¤ã‚º
    'parallel_workers': 10,     # ä¸¦åˆ—ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°
    'timeout_per_file': 60,     # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆç§’ï¼‰
    'rate_limit_per_minute': 100  # ãƒ¬ãƒ¼ãƒˆåˆ¶é™
}
```

### 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥

**åŠ¹æœ**: APIå‘¼ã³å‡ºã—90%å‰Šæ¸›ï¼ˆ2å›ç›®ä»¥é™ï¼‰

```
åˆå›å®Ÿè¡Œ: APIå‘¼ã³å‡ºã— â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜
2å›ç›®ä»¥é™: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ â†’ APIå‘¼ã³å‡ºã—ã‚¹ã‚­ãƒƒãƒ—
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆv3.4å®Œå…¨å¯¾å¿œï¼‰

### 1. ReDoSå¯¾ç­–ï¼ˆè¡Œç•ªå·: 758-762, 1234-1238ï¼‰

```python
# æ–‡å­—æ•°åˆ¶é™ã«ã‚ˆã‚‹ catastrophic backtracking é˜²æ­¢
COMPILED_PATTERNS = {
    'constructor_logic': re.compile(
        r'constructor\s*\([^)]{0,500}\)\s*\{[^}]{0,500}',  # æœ€å¤§500æ–‡å­—
        re.DOTALL
    ),
    'ngOnInit': re.compile(
        r'ngOnInit\s*\(\)\s*\{[^}]{0,500}',  # æœ€å¤§500æ–‡å­—
        re.DOTALL
    )
}
```

### 2. ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«å¯¾ç­–ï¼ˆè¡Œç•ªå·: 1814-1838ï¼‰

```python
def validate_file_path(path: str) -> bool:
    """ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®å®‰å…¨æ€§æ¤œè¨¼"""
    # ".."ã‚’å«ã‚€ãƒ‘ã‚¹ã‚’æ‹’å¦
    if ".." in path:
        return False

    # ãƒ‘ã‚¹ã‚’æ­£è¦åŒ–
    resolved = Path(path).resolve()
    current = Path.cwd()

    # ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå¤–ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶é™
    try:
        resolved.relative_to(current)
        return True
    except ValueError:
        return False
```

### 3. APIèªè¨¼æƒ…å ±ä¿è­·

```python
def mask_sensitive_data(message: str) -> str:
    """ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å†…ã®æ©Ÿå¯†æƒ…å ±ã‚’ãƒã‚¹ã‚¯"""
    # APIã‚­ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³
    patterns = [
        (r'sk-[A-Za-z0-9]{48}', 'sk-***'),  # OpenAI
        (r'sk-ant-[A-Za-z0-9]{48}', 'sk-ant-***'),  # Anthropic
        (r'Bearer [A-Za-z0-9\-._~+/]+', 'Bearer ***'),  # Bearer token
    ]

    for pattern, replacement in patterns:
        message = re.sub(pattern, replacement, message)

    return message
```

### 4. ç’°å¢ƒå¤‰æ•°ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆ

```python
ALLOWED_ENV_VARS = [
    'OPENAI_API_KEY',
    'ANTHROPIC_API_KEY',
    'AI_PROVIDER',
    'OPENAI_MODEL',
    'ANTHROPIC_MODEL'
]

def load_env_safely():
    """å®‰å…¨ãªç’°å¢ƒå¤‰æ•°èª­ã¿è¾¼ã¿"""
    for key in ALLOWED_ENV_VARS:
        if key not in os.environ:  # æ—¢å­˜å¤‰æ•°ã‚’ä¸Šæ›¸ãã—ãªã„
            value = dotenv.get_key('.env', key)
            if value:
                os.environ[key] = value
```

## æ‹¡å¼µæ€§

### æ–°è¨€èªã®è¿½åŠ 

```python
def scan_new_language(text):
    """æ–°è¨€èªã®ã‚¹ã‚­ãƒ£ãƒ³é–¢æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ"""
    results = []

    # è¨€èªå›ºæœ‰ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®šç¾©
    patterns = {
        'pattern1': re.compile(r'...'),
        'pattern2': re.compile(r'...'),
    }

    # SOLIDåŸå‰‡ãƒã‚§ãƒƒã‚¯
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
    # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯

    return results

# ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒãƒ³ã«ç™»éŒ²
LANGUAGE_SCANNERS['newlang'] = scan_new_language
```

### æ–°AIãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®è¿½åŠ 

```python
class NewAIProvider(BaseProvider):
    def __init__(self):
        self.client = NewAIClient(api_key=os.getenv('NEWAI_API_KEY'))

    async def analyze(self, code, model, **kwargs):
        response = await self.client.complete(
            prompt=self.build_prompt(code),
            model=model,
            **kwargs
        )
        return self.parse_response(response)
```

## ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°

### ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«

```python
import logging

# ãƒ­ã‚°è¨­å®š
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('codex_review.log'),
        logging.StreamHandler()
    ]
)

# ä½¿ç”¨ä¾‹
logger.info(f"Processing {file_count} files")
logger.warning(f"Timeout on file: {file_path}")
logger.error(f"API error: {error_message}")
```

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†

```python
METRICS = {
    'files_processed': 0,
    'cache_hits': 0,
    'cache_misses': 0,
    'api_calls': 0,
    'api_errors': 0,
    'total_time': 0.0,
    'issues_found': {
        'critical': 0,
        'high': 0,
        'medium': 0,
        'low': 0
    }
}
```

## ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»

### çŸ­æœŸè¨ˆç”»ï¼ˆv3.5ï¼‰
- WebUIã®è¿½åŠ 
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«å®šç¾©æ©Ÿèƒ½
- IDEçµ±åˆï¼ˆVS Codeæ‹¡å¼µï¼‰

### ä¸­æœŸè¨ˆç”»ï¼ˆv4.0ï¼‰
- æ©Ÿæ¢°å­¦ç¿’ãƒ™ãƒ¼ã‚¹ã®å•é¡Œæ¤œå‡º
- è‡ªå‹•ä¿®æ­£æ©Ÿèƒ½
- ãƒãƒ¼ãƒ å‘ã‘ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå¯¾å¿œ

### é•·æœŸè¨ˆç”»
- è‡ªå·±å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®æœ€é©åŒ–
- ãƒãƒ«ãƒè¨€èªåŒæ™‚åˆ†æ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»èªå®šå¯¾å¿œ

---

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯

### å®Ÿæ¸¬å€¤ï¼ˆ15,710 C#ãƒ•ã‚¡ã‚¤ãƒ«ã€ç´„200ä¸‡è¡Œï¼‰

| å‡¦ç† | v3.3 | v3.4 | æ”¹å–„ç‡ |
|------|------|------|--------|
| ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ | 120ç§’ | 85ç§’ | **29%æ”¹å–„** |
| ãƒ«ãƒ¼ãƒ«åˆ†æ | 45ç§’ | 28ç§’ | **38%æ”¹å–„** |
| AIåˆ†æï¼ˆ100ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ | 600ç§’ | 420ç§’ | **30%æ”¹å–„** |
| ãƒ¡ãƒ¢ãƒªä½¿ç”¨ï¼ˆ30Kãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ | 8GB | 500MB | **94%å‰Šæ¸›** |

### ãƒœãƒˆãƒ«ãƒãƒƒã‚¯åˆ†æ

```python
# ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°çµæœï¼ˆv3.4ï¼‰
{
    'regex_compile': '2%',      # ãƒ—ãƒªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«åŠ¹æœ
    'file_io': '15%',           # ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°åŠ¹æœ
    'encoding_detect': '8%',     # chardetæœ€é©åŒ–
    'rule_analysis': '20%',      # å®šæ•°åŒ–åŠ¹æœ
    'ai_api_call': '45%',       # ä¸¦åˆ—åŒ–ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹æœ
    'report_generation': '10%'   # æœ€é©åŒ–æ¸ˆã¿
}
```

---

*æœ€çµ‚æ›´æ–°: 2025å¹´10æœˆ12æ—¥ JST*
*ãƒãƒ¼ã‚¸ãƒ§ãƒ³: v4.2.2 (Phase 3.3å®Œäº†)*

**æ›´æ–°å±¥æ­´:**
- v4.2.2 (2025å¹´10æœˆ12æ—¥): **Phase 3.3å®Œäº†** - YAMLãƒ«ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ å®Œæˆï¼ˆ10ãƒ«ãƒ¼ãƒ«Ã—4ã‚«ãƒ†ã‚´ãƒªï¼‰ã€æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å¯¾å¿œå‹è§£æã€å…¨ãƒ†ã‚¹ãƒˆ100%åˆæ ¼
- v4.2.1 (2025å¹´10æœˆ12æ—¥): Phase 3.2å®Œäº† - RuleCategoryã‚¯ãƒ©ã‚¹ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ«ãƒ¼ãƒ«é–¢æ•°ã€æ·±åˆ»åº¦èª¿æ•´æ©Ÿèƒ½
- v4.2.0 (2025å¹´10æœˆ12æ—¥): Phase 3.1å®Œäº† - 10å€‹ã®YAMLãƒ«ãƒ¼ãƒ«ä½œæˆã€7è¨€èªã‚µãƒãƒ¼ãƒˆ
- v3.4.1 (2025å¹´09æœˆ02æ—¥): 100ç‚¹é”æˆè©³ç´°ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¿½åŠ ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¿½åŠ 